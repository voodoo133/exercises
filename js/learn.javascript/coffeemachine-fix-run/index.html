<!-- description: http://learn.javascript.ru/task/coffeemachine-fix-run -->
<html>
  <head>
    <meta charset="utf-8"/>
  </head>
  <body>
    <script>
      function Machine(power) {
        this._enabled = false;

        this.enable = function() {
          this._enabled = true;
        };

        this.disable = function() {
          this._enabled = false;
        };
      }

      function CoffeeMachine(power) {
        Machine.apply(this, arguments);

        var waterAmount = 0;

        this.setWaterAmount = function(amount) {
          waterAmount = amount;
        };

        function onReady() {
          alert('Кофе готово!');
        }

        this.run = function() {
          if (this._enabled)
            setTimeout(onReady, 1000);
          else 
            throw new Error('Ошибка, кофеварка выключена!')
        };
      }
      
      var coffeeMachine = new CoffeeMachine(10000);
      coffeeMachine.run(); // ошибка, кофеварка выключена!
      
      var coffeeMachine = new CoffeeMachine(10000);
      coffeeMachine.enable();
      coffeeMachine.run(); // ...Кофе готов!
    </script>
  </body>
</html>