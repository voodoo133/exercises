<!-- description: http://learn.javascript.ru/task/setter-onready -->
<html>
  <head>
    <meta charset="utf-8"/>
  </head>
  <body>
    <script>
      function CoffeeMachine(power, capacity) {
        var waterAmount = 0;

        var WATER_HEAT_CAPACITY = 4200;

        var onReady = function() {
          alert( 'Кофе готов!' );
        }

        function getTimeToBoil() {
          return waterAmount * WATER_HEAT_CAPACITY * 80 / power;
        }

        this.setWaterAmount = function(amount) {
          // ... проверки пропущены для краткости
          waterAmount = amount;
        };

        this.getWaterAmount = function(amount) {
          return waterAmount;
        };

        this.run = function() {
          setTimeout(function () { onReady(); }, getTimeToBoil());
        };
        
        this.setOnReady = function (f) {
          onReady = f;
        }
      }
      
      var coffeeMachine = new CoffeeMachine(20000, 500);
      coffeeMachine.setWaterAmount(150);

      coffeeMachine.run();  

      coffeeMachine.setOnReady(function() {
        var amount = coffeeMachine.getWaterAmount();
        alert( 'Готов кофе: ' + amount + 'мл' ); // Кофе готов: 150 мл
      });

      
    </script>
  </body>
</html>